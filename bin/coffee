#!/usr/bin/env ruby -s
$:.unshift File.dirname(__FILE__) + "/../lib"
require "coffee"

if $h
  puts <<-EOS

            ~== 0xCOFFEE ==~

             To run a file
         coffee -i cappuccino.cof

       To compile to LLVM bytecode
            coffee creamy.cof

  EOS
  exit
end

file = ARGV.first
abort "Usage: coffee [-hiO] file.cof" unless file

case
when $i
  Coffee.interpret(File.read(file))
else
  g = Coffee.compile(File.read(file))
  g.optimize unless $O
  g.to_file(TrueClass === $c ? file + ".o" : $c)
end
